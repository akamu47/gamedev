<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vocab Trainer ‚Äî Ed & John's Game Dev Journey</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@400;600;700;900&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --accent: #6c63ff;
    --correct: #00c853;
    --wrong: #ff3d71;
    --dark: #0a0a14;
    --card: #12121f;
    --card-light: #1a1a2e;
  }

  body {
    font-family: 'Inter', sans-serif;
    background: var(--dark);
    color: #e0e0e0;
    line-height: 1.7;
    min-height: 100vh;
  }

  .top-nav {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(10,10,20,0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255,255,255,0.06);
    padding: 10px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .top-nav a {
    color: #888;
    text-decoration: none;
    font-size: 0.8rem;
    font-weight: 600;
    transition: color 0.2s;
  }

  .top-nav a:hover { color: #fff; }
  .top-nav .back-link { display: flex; align-items: center; gap: 6px; }
  .top-nav .project-links { display: flex; gap: 12px; }
  .top-nav .project-links a.active { color: var(--accent); }

  .hero {
    background: linear-gradient(135deg, #0a0a14 0%, #1a1028 40%, #0f1a2e 100%);
    padding: 45px 20px 35px;
    text-align: center;
    border-bottom: 3px solid var(--accent);
  }

  .hero h1 {
    font-family: 'Press Start 2P', cursive;
    font-size: clamp(1.2rem, 3.5vw, 2rem);
    color: var(--accent);
    text-shadow: 0 0 20px rgba(108,99,255,0.4);
    margin-bottom: 8px;
  }

  .hero .subtitle { font-size: 0.95rem; color: #888; }

  .container {
    max-width: 700px;
    margin: 0 auto;
    padding: 30px 20px;
  }

  /* Tabs */
  .tab-row {
    display: flex;
    gap: 0;
    margin-bottom: 25px;
    border-radius: 10px;
    overflow: hidden;
    border: 1px solid rgba(255,255,255,0.08);
  }

  .tab-btn {
    flex: 1;
    padding: 12px;
    font-family: 'Inter', sans-serif;
    font-size: 0.8rem;
    font-weight: 700;
    border: none;
    background: var(--card);
    color: #666;
    cursor: pointer;
    transition: all 0.2s;
  }

  .tab-btn:hover { color: #aaa; }
  .tab-btn.active { background: var(--accent); color: #fff; }

  .tab-content { display: none; }
  .tab-content.active { display: block; }

  /* Dropdowns & inputs */
  label {
    display: block;
    font-size: 0.75rem;
    font-weight: 700;
    color: #888;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 6px;
    margin-top: 18px;
  }

  label:first-child { margin-top: 0; }

  select, input[type="text"], input[type="number"] {
    width: 100%;
    padding: 12px 14px;
    font-family: 'Inter', sans-serif;
    font-size: 0.95rem;
    background: var(--card);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 10px;
    color: #e0e0e0;
    outline: none;
    transition: border-color 0.2s;
  }

  select:focus, input:focus {
    border-color: var(--accent);
  }

  select option {
    background: var(--card);
    color: #e0e0e0;
  }

  .btn {
    font-family: 'Inter', sans-serif;
    font-size: 0.9rem;
    font-weight: 700;
    padding: 14px 28px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: transform 0.15s, box-shadow 0.15s;
    color: white;
    margin-top: 20px;
  }

  .btn:hover { transform: translateY(-2px); }
  .btn:active { transform: translateY(0); }

  .btn-primary {
    background: linear-gradient(135deg, var(--accent), #5a52d5);
    box-shadow: 0 4px 20px rgba(108,99,255,0.3);
  }

  .btn-success {
    background: linear-gradient(135deg, var(--correct), #00a844);
    box-shadow: 0 4px 20px rgba(0,200,83,0.3);
  }

  .btn-danger {
    background: linear-gradient(135deg, var(--wrong), #cc2255);
    box-shadow: 0 4px 20px rgba(255,61,113,0.2);
  }

  .btn-sm {
    font-size: 0.8rem;
    padding: 8px 16px;
    margin-top: 10px;
  }

  .btn-row {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }

  /* Word count badge */
  .word-count {
    display: inline-block;
    background: rgba(108,99,255,0.15);
    color: var(--accent);
    font-size: 0.75rem;
    font-weight: 700;
    padding: 4px 12px;
    border-radius: 20px;
    margin-top: 10px;
  }

  /* Custom list builder */
  .word-pair-row {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-bottom: 8px;
  }

  .word-pair-row input {
    flex: 1;
  }

  .remove-word {
    background: transparent;
    border: 1px solid rgba(255,61,113,0.3);
    color: var(--wrong);
    width: 34px;
    height: 34px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    flex-shrink: 0;
  }

  .remove-word:hover { background: rgba(255,61,113,0.1); }

  .custom-words-list {
    max-height: 300px;
    overflow-y: auto;
    margin-top: 10px;
  }

  .lookup-status {
    font-size: 0.75rem;
    margin-top: 4px;
  }

  .lookup-found { color: var(--correct); }
  .lookup-manual { color: var(--wrong); }

  /* Quiz area */
  .quiz-area {
    display: none;
  }

  .quiz-area.active {
    display: block;
  }

  .setup-area.hidden { display: none; }

  .quiz-card {
    background: var(--card);
    border: 2px solid rgba(108,99,255,0.2);
    border-radius: 16px;
    padding: 35px 25px;
    text-align: center;
    margin-bottom: 20px;
  }

  .quiz-card .direction {
    font-size: 0.7rem;
    font-weight: 700;
    color: #666;
    text-transform: uppercase;
    letter-spacing: 2px;
    margin-bottom: 12px;
  }

  .quiz-card .prompt-word {
    font-size: 1.8rem;
    font-weight: 900;
    color: #fff;
    margin-bottom: 5px;
  }

  .quiz-card .prompt-lang {
    font-size: 0.8rem;
    color: var(--accent);
    font-weight: 600;
  }

  .answer-input {
    width: 100%;
    padding: 14px;
    font-size: 1.1rem;
    text-align: center;
    background: var(--card-light);
    border: 2px solid rgba(255,255,255,0.1);
    border-radius: 12px;
    color: #fff;
    outline: none;
    font-family: 'Inter', sans-serif;
    transition: border-color 0.2s;
  }

  .answer-input:focus { border-color: var(--accent); }
  .answer-input.correct { border-color: var(--correct); background: rgba(0,200,83,0.08); }
  .answer-input.wrong { border-color: var(--wrong); background: rgba(255,61,113,0.08); }

  .feedback {
    text-align: center;
    margin-top: 12px;
    font-weight: 700;
    font-size: 0.95rem;
    min-height: 30px;
  }

  .feedback.correct-fb { color: var(--correct); }
  .feedback.wrong-fb { color: var(--wrong); }

  .correct-answer {
    color: #aaa;
    font-size: 0.85rem;
    margin-top: 4px;
  }

  /* Score board */
  .scoreboard {
    display: flex;
    justify-content: center;
    gap: 25px;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }

  .score-item {
    text-align: center;
  }

  .score-item .num {
    font-family: 'Press Start 2P', cursive;
    font-size: 1.2rem;
    display: block;
  }

  .score-item .lbl {
    font-size: 0.7rem;
    color: #666;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-top: 4px;
  }

  .score-correct .num { color: var(--correct); }
  .score-wrong .num { color: var(--wrong); }
  .score-total .num { color: var(--accent); }
  .score-streak .num { color: #ffd23f; }

  .progress-bar-quiz {
    background: #1a1a2e;
    border-radius: 10px;
    height: 8px;
    overflow: hidden;
    margin-bottom: 20px;
  }

  .progress-bar-quiz .fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), #9b59b6);
    border-radius: 10px;
    transition: width 0.3s;
  }

  /* Results screen */
  .results-screen {
    display: none;
    text-align: center;
    padding: 30px 0;
  }

  .results-screen.active { display: block; }

  .results-screen .big-score {
    font-family: 'Press Start 2P', cursive;
    font-size: 2.5rem;
    margin: 15px 0;
  }

  .results-screen .grade {
    font-size: 1.1rem;
    color: #aaa;
    margin-bottom: 20px;
  }

  .missed-words {
    text-align: left;
    background: var(--card);
    border-radius: 12px;
    padding: 20px;
    margin: 20px 0;
  }

  .missed-words h4 {
    font-size: 0.8rem;
    color: var(--wrong);
    margin-bottom: 10px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .missed-word-item {
    padding: 6px 0;
    border-bottom: 1px solid rgba(255,255,255,0.04);
    font-size: 0.9rem;
    display: flex;
    justify-content: space-between;
  }

  .missed-word-item:last-child { border-bottom: none; }
  .missed-word-item .eng { color: #aaa; }
  .missed-word-item .foreign { color: var(--accent); }

  /* Saved lists */
  .saved-list-item {
    background: var(--card);
    border: 1px solid rgba(255,255,255,0.06);
    border-radius: 10px;
    padding: 12px 16px;
    margin-bottom: 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    transition: border-color 0.2s;
  }

  .saved-list-item:hover { border-color: var(--accent); }

  .saved-list-info .name { font-weight: 700; font-size: 0.9rem; }
  .saved-list-info .meta { font-size: 0.75rem; color: #666; }

  .delete-list {
    background: transparent;
    border: none;
    color: #555;
    font-size: 1.1rem;
    cursor: pointer;
    padding: 5px;
    transition: color 0.2s;
  }

  .delete-list:hover { color: var(--wrong); }

  .empty-state {
    text-align: center;
    padding: 30px;
    color: #444;
    font-size: 0.9rem;
  }

  footer {
    text-align: center;
    padding: 30px;
    color: #333;
    font-size: 0.8rem;
    border-top: 1px solid #1a1a1a;
  }
</style>
</head>
<body>

<nav class="top-nav">
  <a href="index.html" class="back-link">‚Üê Home</a>
  <div class="project-links">
    <a href="project-1-battle-cards.html">1</a>
    <a href="project-2-roblox-adventure.html">2</a>
    <a href="project-3-mobile-arcade.html">3</a>
    <a href="project-4-geometry-dash.html">4</a>
    <a href="fun-zone.html">Fun</a>
    <a href="vocab-trainer.html" class="active">Vocab</a>
  </div>
</nav>

<div class="hero">
  <h1>üìö VOCAB TRAINER</h1>
  <div class="subtitle">Learn French, Russian, Latin & Greek ‚Äî the fun way</div>
</div>

<div class="container">

  <!-- TABS -->
  <div class="tab-row">
    <button class="tab-btn active" data-tab="practice">Practice</button>
    <button class="tab-btn" data-tab="custom">Custom Lists</button>
    <button class="tab-btn" data-tab="saved">My Lists</button>
  </div>

  <!-- ===== PRACTICE TAB ===== -->
  <div class="tab-content active" id="tab-practice">

    <div class="setup-area" id="setupArea">
      <label>Language</label>
      <select id="langSelect">
        <option value="french">üá´üá∑ French</option>
        <option value="russian">üá∑üá∫ Russian</option>
        <option value="latin">üèõÔ∏è Latin</option>
        <option value="greek">üá¨üá∑ Greek</option>
      </select>

      <label>Category</label>
      <select id="catSelect">
        <option value="numbers">Numbers (1‚Äì20)</option>
        <option value="colours">Colours</option>
        <option value="animals">Animals</option>
        <option value="food">Food & Drink</option>
        <option value="family">Family</option>
        <option value="body">Body Parts</option>
        <option value="days">Days & Months</option>
        <option value="school">School</option>
        <option value="phrases">Common Phrases</option>
        <option value="nature">Nature</option>
      </select>

      <label>Quiz Direction</label>
      <select id="dirSelect">
        <option value="en-to-foreign">English ‚Üí Foreign</option>
        <option value="foreign-to-en">Foreign ‚Üí English</option>
        <option value="mixed">Mixed (both ways)</option>
      </select>

      <label>Number of Questions</label>
      <select id="numSelect">
        <option value="5">5 (Quick)</option>
        <option value="10" selected>10 (Standard)</option>
        <option value="15">15 (Challenge)</option>
        <option value="all">All words in category</option>
      </select>

      <div class="word-count" id="wordCount">10 words available</div>

      <button class="btn btn-primary" onclick="startQuiz()" style="width:100%">Start Quiz</button>
    </div>

    <!-- QUIZ -->
    <div class="quiz-area" id="quizArea">
      <div class="scoreboard">
        <div class="score-item score-correct">
          <span class="num" id="scoreCorrect">0</span>
          <span class="lbl">Correct</span>
        </div>
        <div class="score-item score-wrong">
          <span class="num" id="scoreWrong">0</span>
          <span class="lbl">Wrong</span>
        </div>
        <div class="score-item score-total">
          <span class="num" id="scoreProgress">0/10</span>
          <span class="lbl">Progress</span>
        </div>
        <div class="score-item score-streak">
          <span class="num" id="scoreStreak">0</span>
          <span class="lbl">Streak</span>
        </div>
      </div>

      <div class="progress-bar-quiz">
        <div class="fill" id="quizProgress" style="width: 0%"></div>
      </div>

      <div class="quiz-card" id="quizCard">
        <div class="direction" id="quizDirection">Translate to French</div>
        <div class="prompt-word" id="quizWord">hello</div>
        <div class="prompt-lang" id="quizLang">English</div>
      </div>

      <input type="text" class="answer-input" id="answerInput" placeholder="Type your answer..." autocomplete="off" autocapitalize="off">

      <div class="feedback" id="feedback"></div>

      <div class="btn-row" style="justify-content: center;">
        <button class="btn btn-primary" id="checkBtn" onclick="checkAnswer()">Check</button>
        <button class="btn btn-success" id="nextBtn" onclick="nextQuestion()" style="display:none">Next ‚Üí</button>
      </div>

      <button class="btn btn-danger btn-sm" onclick="endQuiz()" style="margin-top: 20px; display: block; margin-left: auto; margin-right: auto;">End Quiz</button>
    </div>

    <!-- RESULTS -->
    <div class="results-screen" id="resultsScreen">
      <span style="font-size: 3rem;" id="resultsEmoji">üéâ</span>
      <div class="big-score" id="resultsScore" style="color: var(--correct);">8/10</div>
      <div class="grade" id="resultsGrade">Great job!</div>

      <div class="missed-words" id="missedWords" style="display:none;">
        <h4>Words to Review</h4>
        <div id="missedList"></div>
      </div>

      <div class="btn-row" style="justify-content: center;">
        <button class="btn btn-primary" onclick="retryQuiz()">Try Again</button>
        <button class="btn btn-success" onclick="backToSetup()">New Quiz</button>
      </div>
    </div>

  </div>

  <!-- ===== CUSTOM LISTS TAB ===== -->
  <div class="tab-content" id="tab-custom">

    <label>List Name</label>
    <input type="text" id="customListName" placeholder="e.g. French Year 9 Vocab">

    <label>Language</label>
    <select id="customLang">
      <option value="french">üá´üá∑ French</option>
      <option value="russian">üá∑üá∫ Russian</option>
      <option value="latin">üèõÔ∏è Latin</option>
      <option value="greek">üá¨üá∑ Greek</option>
    </select>

    <label style="margin-top: 20px;">Add Words</label>
    <p style="font-size: 0.8rem; color: #666; margin-bottom: 10px;">Type the English word and we'll try to find the translation. If we can't find it, you can type it yourself.</p>

    <div class="word-pair-row">
      <input type="text" id="newEnglish" placeholder="English word">
      <input type="text" id="newForeign" placeholder="Translation (auto or manual)">
      <button class="btn btn-primary btn-sm" onclick="addWordPair()" style="margin-top: 0; white-space: nowrap;">+ Add</button>
    </div>
    <div class="lookup-status" id="lookupStatus"></div>

    <div class="custom-words-list" id="customWordsList"></div>

    <div class="btn-row">
      <button class="btn btn-success" onclick="saveCustomList()">Save List</button>
      <button class="btn btn-danger btn-sm" onclick="clearCustomWords()" style="margin-top: 20px;">Clear All</button>
    </div>

  </div>

  <!-- ===== SAVED LISTS TAB ===== -->
  <div class="tab-content" id="tab-saved">
    <div id="savedListsContainer">
      <div class="empty-state">No saved lists yet. Create one in the Custom Lists tab!</div>
    </div>
  </div>

</div>

<footer>
  Ed & John's Game Dev Journey ‚Äî Vocab Trainer
</footer>

<script>
// ==========================================
// VOCABULARY DATABASE
// ==========================================
const vocab = {
  french: {
    numbers: [
      ["one","un"],["two","deux"],["three","trois"],["four","quatre"],["five","cinq"],
      ["six","six"],["seven","sept"],["eight","huit"],["nine","neuf"],["ten","dix"],
      ["eleven","onze"],["twelve","douze"],["thirteen","treize"],["fourteen","quatorze"],["fifteen","quinze"],
      ["sixteen","seize"],["seventeen","dix-sept"],["eighteen","dix-huit"],["nineteen","dix-neuf"],["twenty","vingt"]
    ],
    colours: [
      ["red","rouge"],["blue","bleu"],["green","vert"],["yellow","jaune"],["black","noir"],
      ["white","blanc"],["orange","orange"],["pink","rose"],["purple","violet"],["brown","marron"],
      ["grey","gris"],["gold","or"],["silver","argent"]
    ],
    animals: [
      ["dog","chien"],["cat","chat"],["bird","oiseau"],["fish","poisson"],["horse","cheval"],
      ["cow","vache"],["pig","cochon"],["sheep","mouton"],["rabbit","lapin"],["mouse","souris"],
      ["chicken","poulet"],["duck","canard"],["bear","ours"],["wolf","loup"],["snake","serpent"]
    ],
    food: [
      ["bread","pain"],["cheese","fromage"],["milk","lait"],["water","eau"],["apple","pomme"],
      ["chicken","poulet"],["rice","riz"],["egg","oeuf"],["butter","beurre"],["sugar","sucre"],
      ["cake","g√¢teau"],["chocolate","chocolat"],["ice cream","glace"],["meat","viande"],["salad","salade"]
    ],
    family: [
      ["mother","m√®re"],["father","p√®re"],["brother","fr√®re"],["sister","soeur"],["son","fils"],
      ["daughter","fille"],["grandmother","grand-m√®re"],["grandfather","grand-p√®re"],["uncle","oncle"],["aunt","tante"],
      ["cousin","cousin"],["family","famille"],["parents","parents"],["child","enfant"],["baby","b√©b√©"]
    ],
    body: [
      ["head","t√™te"],["hand","main"],["foot","pied"],["arm","bras"],["leg","jambe"],
      ["eye","oeil"],["ear","oreille"],["nose","nez"],["mouth","bouche"],["hair","cheveux"],
      ["finger","doigt"],["shoulder","√©paule"],["knee","genou"],["heart","coeur"],["back","dos"]
    ],
    days: [
      ["Monday","lundi"],["Tuesday","mardi"],["Wednesday","mercredi"],["Thursday","jeudi"],["Friday","vendredi"],
      ["Saturday","samedi"],["Sunday","dimanche"],["January","janvier"],["February","f√©vrier"],["March","mars"],
      ["April","avril"],["May","mai"],["June","juin"],["July","juillet"],["August","ao√ªt"],
      ["September","septembre"],["October","octobre"],["November","novembre"],["December","d√©cembre"]
    ],
    school: [
      ["school","√©cole"],["teacher","professeur"],["student","√©l√®ve"],["book","livre"],["pen","stylo"],
      ["pencil","crayon"],["table","table"],["chair","chaise"],["classroom","salle de classe"],["homework","devoirs"],
      ["exam","examen"],["lesson","le√ßon"],["maths","math√©matiques"],["science","sciences"],["history","histoire"]
    ],
    phrases: [
      ["hello","bonjour"],["goodbye","au revoir"],["please","s'il vous pla√Æt"],["thank you","merci"],["yes","oui"],
      ["no","non"],["how are you","comment allez-vous"],["my name is","je m'appelle"],["excuse me","excusez-moi"],["sorry","d√©sol√©"],
      ["good morning","bonjour"],["good evening","bonsoir"],["good night","bonne nuit"],["see you later","√† bient√¥t"],["well done","bravo"]
    ],
    nature: [
      ["tree","arbre"],["flower","fleur"],["sun","soleil"],["moon","lune"],["star","√©toile"],
      ["sea","mer"],["mountain","montagne"],["river","rivi√®re"],["sky","ciel"],["rain","pluie"],
      ["snow","neige"],["wind","vent"],["forest","for√™t"],["garden","jardin"],["beach","plage"]
    ]
  },
  russian: {
    numbers: [
      ["one","–æ–¥–∏–Ω"],["two","–¥–≤–∞"],["three","—Ç—Ä–∏"],["four","—á–µ—Ç—ã—Ä–µ"],["five","–ø—è—Ç—å"],
      ["six","—à–µ—Å—Ç—å"],["seven","—Å–µ–º—å"],["eight","–≤–æ—Å–µ–º—å"],["nine","–¥–µ–≤—è—Ç—å"],["ten","–¥–µ—Å—è—Ç—å"],
      ["eleven","–æ–¥–∏–Ω–Ω–∞–¥—Ü–∞—Ç—å"],["twelve","–¥–≤–µ–Ω–∞–¥—Ü–∞—Ç—å"],["thirteen","—Ç—Ä–∏–Ω–∞–¥—Ü–∞—Ç—å"],["fourteen","—á–µ—Ç—ã—Ä–Ω–∞–¥—Ü–∞—Ç—å"],["fifteen","–ø—è—Ç–Ω–∞–¥—Ü–∞—Ç—å"],
      ["sixteen","—à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç—å"],["seventeen","—Å–µ–º–Ω–∞–¥—Ü–∞—Ç—å"],["eighteen","–≤–æ—Å–µ–º–Ω–∞–¥—Ü–∞—Ç—å"],["nineteen","–¥–µ–≤—è—Ç–Ω–∞–¥—Ü–∞—Ç—å"],["twenty","–¥–≤–∞–¥—Ü–∞—Ç—å"]
    ],
    colours: [
      ["red","–∫—Ä–∞—Å–Ω—ã–π"],["blue","—Å–∏–Ω–∏–π"],["green","–∑–µ–ª—ë–Ω—ã–π"],["yellow","–∂—ë–ª—Ç—ã–π"],["black","—á—ë—Ä–Ω—ã–π"],
      ["white","–±–µ–ª—ã–π"],["orange","–æ—Ä–∞–Ω–∂–µ–≤—ã–π"],["pink","—Ä–æ–∑–æ–≤—ã–π"],["purple","—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π"],["brown","–∫–æ—Ä–∏—á–Ω–µ–≤—ã–π"],
      ["grey","—Å–µ—Ä—ã–π"],["gold","–∑–æ–ª–æ—Ç–æ–π"],["silver","—Å–µ—Ä–µ–±—Ä—è–Ω—ã–π"]
    ],
    animals: [
      ["dog","—Å–æ–±–∞–∫–∞"],["cat","–∫–æ—à–∫–∞"],["bird","–ø—Ç–∏—Ü–∞"],["fish","—Ä—ã–±–∞"],["horse","–ª–æ—à–∞–¥—å"],
      ["cow","–∫–æ—Ä–æ–≤–∞"],["pig","—Å–≤–∏–Ω—å—è"],["sheep","–æ–≤—Ü–∞"],["rabbit","–∫—Ä–æ–ª–∏–∫"],["mouse","–º—ã—à—å"],
      ["chicken","–∫—É—Ä–∏—Ü–∞"],["duck","—É—Ç–∫–∞"],["bear","–º–µ–¥–≤–µ–¥—å"],["wolf","–≤–æ–ª–∫"],["snake","–∑–º–µ—è"]
    ],
    food: [
      ["bread","—Ö–ª–µ–±"],["cheese","—Å—ã—Ä"],["milk","–º–æ–ª–æ–∫–æ"],["water","–≤–æ–¥–∞"],["apple","—è–±–ª–æ–∫–æ"],
      ["chicken","–∫—É—Ä–∏—Ü–∞"],["rice","—Ä–∏—Å"],["egg","—è–π—Ü–æ"],["butter","–º–∞—Å–ª–æ"],["sugar","—Å–∞—Ö–∞—Ä"],
      ["cake","—Ç–æ—Ä—Ç"],["chocolate","—à–æ–∫–æ–ª–∞–¥"],["ice cream","–º–æ—Ä–æ–∂–µ–Ω–æ–µ"],["meat","–º—è—Å–æ"],["salad","—Å–∞–ª–∞—Ç"]
    ],
    family: [
      ["mother","–º–∞–º–∞"],["father","–ø–∞–ø–∞"],["brother","–±—Ä–∞—Ç"],["sister","—Å–µ—Å—Ç—Ä–∞"],["son","—Å—ã–Ω"],
      ["daughter","–¥–æ—á—å"],["grandmother","–±–∞–±—É—à–∫–∞"],["grandfather","–¥–µ–¥—É—à–∫–∞"],["uncle","–¥—è–¥—è"],["aunt","—Ç—ë—Ç—è"],
      ["cousin","–¥–≤–æ—é—Ä–æ–¥–Ω—ã–π –±—Ä–∞—Ç"],["family","—Å–µ–º—å—è"],["parents","—Ä–æ–¥–∏—Ç–µ–ª–∏"],["child","—Ä–µ–±—ë–Ω–æ–∫"],["baby","–º–∞–ª—ã—à"]
    ],
    body: [
      ["head","–≥–æ–ª–æ–≤–∞"],["hand","—Ä—É–∫–∞"],["foot","–Ω–æ–≥–∞"],["arm","—Ä—É–∫–∞"],["leg","–Ω–æ–≥–∞"],
      ["eye","–≥–ª–∞–∑"],["ear","—É—Ö–æ"],["nose","–Ω–æ—Å"],["mouth","—Ä–æ—Ç"],["hair","–≤–æ–ª–æ—Å—ã"],
      ["finger","–ø–∞–ª–µ—Ü"],["shoulder","–ø–ª–µ—á–æ"],["knee","–∫–æ–ª–µ–Ω–æ"],["heart","—Å–µ—Ä–¥—Ü–µ"],["back","—Å–ø–∏–Ω–∞"]
    ],
    days: [
      ["Monday","–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫"],["Tuesday","–≤—Ç–æ—Ä–Ω–∏–∫"],["Wednesday","—Å—Ä–µ–¥–∞"],["Thursday","—á–µ—Ç–≤–µ—Ä–≥"],["Friday","–ø—è—Ç–Ω–∏—Ü–∞"],
      ["Saturday","—Å—É–±–±–æ—Ç–∞"],["Sunday","–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"],["January","—è–Ω–≤–∞—Ä—å"],["February","—Ñ–µ–≤—Ä–∞–ª—å"],["March","–º–∞—Ä—Ç"],
      ["April","–∞–ø—Ä–µ–ª—å"],["May","–º–∞–π"],["June","–∏—é–Ω—å"],["July","–∏—é–ª—å"],["August","–∞–≤–≥—É—Å—Ç"],
      ["September","—Å–µ–Ω—Ç—è–±—Ä—å"],["October","–æ–∫—Ç—è–±—Ä—å"],["November","–Ω–æ—è–±—Ä—å"],["December","–¥–µ–∫–∞–±—Ä—å"]
    ],
    school: [
      ["school","—à–∫–æ–ª–∞"],["teacher","—É—á–∏—Ç–µ–ª—å"],["student","—É—á–µ–Ω–∏–∫"],["book","–∫–Ω–∏–≥–∞"],["pen","—Ä—É—á–∫–∞"],
      ["pencil","–∫–∞—Ä–∞–Ω–¥–∞—à"],["table","—Å—Ç–æ–ª"],["chair","—Å—Ç—É–ª"],["classroom","–∫–ª–∞—Å—Å"],["homework","–¥–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ"],
      ["exam","—ç–∫–∑–∞–º–µ–Ω"],["lesson","—É—Ä–æ–∫"],["maths","–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞"],["science","–Ω–∞—É–∫–∞"],["history","–∏—Å—Ç–æ—Ä–∏—è"]
    ],
    phrases: [
      ["hello","–ø—Ä–∏–≤–µ—Ç"],["goodbye","–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è"],["please","–ø–æ–∂–∞–ª—É–π—Å—Ç–∞"],["thank you","—Å–ø–∞—Å–∏–±–æ"],["yes","–¥–∞"],
      ["no","–Ω–µ—Ç"],["how are you","–∫–∞–∫ –¥–µ–ª–∞"],["my name is","–º–µ–Ω—è –∑–æ–≤—É—Ç"],["excuse me","–∏–∑–≤–∏–Ω–∏—Ç–µ"],["sorry","–ø—Ä–æ—Å—Ç–∏—Ç–µ"],
      ["good morning","–¥–æ–±—Ä–æ–µ —É—Ç—Ä–æ"],["good evening","–¥–æ–±—Ä—ã–π –≤–µ—á–µ—Ä"],["good night","—Å–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏"],["see you later","–¥–æ —Å–∫–æ—Ä–æ–≥–æ"],["well done","–º–æ–ª–æ–¥–µ—Ü"]
    ],
    nature: [
      ["tree","–¥–µ—Ä–µ–≤–æ"],["flower","—Ü–≤–µ—Ç–æ–∫"],["sun","—Å–æ–ª–Ω—Ü–µ"],["moon","–ª—É–Ω–∞"],["star","–∑–≤–µ–∑–¥–∞"],
      ["sea","–º–æ—Ä–µ"],["mountain","–≥–æ—Ä–∞"],["river","—Ä–µ–∫–∞"],["sky","–Ω–µ–±–æ"],["rain","–¥–æ–∂–¥—å"],
      ["snow","—Å–Ω–µ–≥"],["wind","–≤–µ—Ç–µ—Ä"],["forest","–ª–µ—Å"],["garden","—Å–∞–¥"],["beach","–ø–ª—è–∂"]
    ]
  },
  latin: {
    numbers: [
      ["one","unus"],["two","duo"],["three","tres"],["four","quattuor"],["five","quinque"],
      ["six","sex"],["seven","septem"],["eight","octo"],["nine","novem"],["ten","decem"],
      ["eleven","undecim"],["twelve","duodecim"],["thirteen","tredecim"],["fourteen","quattuordecim"],["fifteen","quindecim"],
      ["sixteen","sedecim"],["seventeen","septendecim"],["eighteen","duodeviginti"],["nineteen","undeviginti"],["twenty","viginti"]
    ],
    colours: [
      ["red","ruber"],["blue","caeruleus"],["green","viridis"],["yellow","flavus"],["black","niger"],
      ["white","albus"],["purple","purpureus"],["brown","fuscus"],["grey","canus"],["gold","aureus"],
      ["silver","argenteus"]
    ],
    animals: [
      ["dog","canis"],["cat","felis"],["bird","avis"],["fish","piscis"],["horse","equus"],
      ["cow","bos"],["pig","porcus"],["sheep","ovis"],["rabbit","cuniculus"],["mouse","mus"],
      ["chicken","gallus"],["duck","anas"],["bear","ursus"],["wolf","lupus"],["snake","serpens"],
      ["lion","leo"],["eagle","aquila"]
    ],
    food: [
      ["bread","panis"],["cheese","caseus"],["milk","lac"],["water","aqua"],["apple","malum"],
      ["wine","vinum"],["egg","ovum"],["salt","sal"],["honey","mel"],["meat","caro"],
      ["oil","oleum"],["grain","frumentum"],["fruit","fructus"],["fish","piscis"]
    ],
    family: [
      ["mother","mater"],["father","pater"],["brother","frater"],["sister","soror"],["son","filius"],
      ["daughter","filia"],["grandmother","avia"],["grandfather","avus"],["uncle","avunculus"],["aunt","amita"],
      ["family","familia"],["parents","parentes"],["child","infans"],["husband","maritus"],["wife","uxor"]
    ],
    body: [
      ["head","caput"],["hand","manus"],["foot","pes"],["arm","bracchium"],["leg","crus"],
      ["eye","oculus"],["ear","auris"],["nose","nasus"],["mouth","os"],["hair","capillus"],
      ["finger","digitus"],["shoulder","umerus"],["heart","cor"],["back","dorsum"],["blood","sanguis"]
    ],
    days: [
      ["Monday","dies Lunae"],["Tuesday","dies Martis"],["Wednesday","dies Mercurii"],["Thursday","dies Iovis"],["Friday","dies Veneris"],
      ["Saturday","dies Saturni"],["Sunday","dies Solis"],["January","Ianuarius"],["February","Februarius"],["March","Martius"],
      ["April","Aprilis"],["May","Maius"],["June","Iunius"],["July","Iulius"],["August","Augustus"],
      ["September","September"],["October","October"],["November","November"],["December","December"]
    ],
    school: [
      ["school","schola"],["teacher","magister"],["student","discipulus"],["book","liber"],["pen","calamus"],
      ["table","mensa"],["chair","sella"],["homework","pensum"],["lesson","lectio"],["science","scientia"],
      ["history","historia"],["war","bellum"],["peace","pax"],["truth","veritas"],["wisdom","sapientia"]
    ],
    phrases: [
      ["hello","salve"],["goodbye","vale"],["please","quaeso"],["thank you","gratias tibi"],["yes","ita"],
      ["no","minime"],["how are you","quid agis"],["my name is","nomen mihi est"],["excuse me","ignosce mihi"],["well done","bene factum"],
      ["good morning","bonum mane"],["I love","amo"],["I see","video"],["I know","scio"],["friend","amicus"]
    ],
    nature: [
      ["tree","arbor"],["flower","flos"],["sun","sol"],["moon","luna"],["star","stella"],
      ["sea","mare"],["mountain","mons"],["river","flumen"],["sky","caelum"],["rain","pluvia"],
      ["snow","nix"],["wind","ventus"],["forest","silva"],["garden","hortus"],["earth","terra"]
    ]
  },
  greek: {
    numbers: [
      ["one","Œ≠ŒΩŒ±"],["two","Œ¥œçŒø"],["three","œÑœÅŒØŒ±"],["four","œÑŒ≠œÉœÉŒµœÅŒ±"],["five","œÄŒ≠ŒΩœÑŒµ"],
      ["six","Œ≠ŒæŒπ"],["seven","ŒµœÜœÑŒ¨"],["eight","ŒøœáœÑœé"],["nine","ŒµŒΩŒΩŒπŒ¨"],["ten","Œ¥Œ≠Œ∫Œ±"],
      ["eleven","Œ≠ŒΩœÑŒµŒ∫Œ±"],["twelve","Œ¥œéŒ¥ŒµŒ∫Œ±"],["thirteen","Œ¥ŒµŒ∫Œ±œÑœÅŒØŒ±"],["fourteen","Œ¥ŒµŒ∫Œ±œÑŒ≠œÉœÉŒµœÅŒ±"],["fifteen","Œ¥ŒµŒ∫Œ±œÄŒ≠ŒΩœÑŒµ"],
      ["sixteen","Œ¥ŒµŒ∫Œ±Œ≠ŒæŒπ"],["seventeen","Œ¥ŒµŒ∫Œ±ŒµœÜœÑŒ¨"],["eighteen","Œ¥ŒµŒ∫Œ±ŒøœáœÑœé"],["nineteen","Œ¥ŒµŒ∫Œ±ŒµŒΩŒΩŒπŒ¨"],["twenty","ŒµŒØŒ∫ŒøœÉŒπ"]
    ],
    colours: [
      ["red","Œ∫œåŒ∫Œ∫ŒπŒΩŒø"],["blue","ŒºœÄŒªŒµ"],["green","œÄœÅŒ¨œÉŒπŒΩŒø"],["yellow","Œ∫ŒØœÑœÅŒπŒΩŒø"],["black","ŒºŒ±œçœÅŒø"],
      ["white","Œ¨œÉœÄœÅŒø"],["orange","œÄŒøœÅœÑŒøŒ∫Œ±ŒªŒØ"],["pink","œÅŒøŒ∂"],["purple","ŒºœâŒ≤"],["brown","Œ∫Œ±œÜŒ≠"],
      ["grey","Œ≥Œ∫œÅŒπ"],["gold","œáœÅœÖœÉœå"],["silver","Œ±œÉŒ∑ŒºŒØ"]
    ],
    animals: [
      ["dog","œÉŒ∫œçŒªŒøœÇ"],["cat","Œ≥Œ¨œÑŒ±"],["bird","œÄŒøœÖŒªŒØ"],["fish","œàŒ¨œÅŒπ"],["horse","Œ¨ŒªŒøŒ≥Œø"],
      ["cow","Œ±Œ≥ŒµŒªŒ¨Œ¥Œ±"],["pig","Œ≥ŒøœÖœÅŒøœçŒΩŒπ"],["sheep","œÄœÅœåŒ≤Œ±œÑŒø"],["rabbit","Œ∫ŒøœÖŒΩŒ≠ŒªŒπ"],["mouse","œÄŒøŒΩœÑŒØŒ∫Œπ"],
      ["chicken","Œ∫ŒøœÑœåœÄŒøœÖŒªŒø"],["duck","œÄŒ¨œÄŒπŒ±"],["bear","Œ±œÅŒ∫ŒøœçŒ¥Œ±"],["wolf","ŒªœçŒ∫ŒøœÇ"],["snake","œÜŒØŒ¥Œπ"]
    ],
    food: [
      ["bread","œàœâŒºŒØ"],["cheese","œÑœÖœÅŒØ"],["milk","Œ≥Œ¨ŒªŒ±"],["water","ŒΩŒµœÅœå"],["apple","ŒºŒÆŒªŒø"],
      ["chicken","Œ∫ŒøœÑœåœÄŒøœÖŒªŒø"],["rice","œÅœçŒ∂Œπ"],["egg","Œ±œÖŒ≥œå"],["butter","Œ≤ŒøœçœÑœÖœÅŒø"],["sugar","Œ∂Œ¨œáŒ±œÅŒ∑"],
      ["cake","Œ∫Œ≠ŒπŒ∫"],["chocolate","œÉŒøŒ∫ŒøŒªŒ¨œÑŒ±"],["ice cream","œÄŒ±Œ≥œâœÑœå"],["meat","Œ∫œÅŒ≠Œ±œÇ"],["salad","œÉŒ±ŒªŒ¨œÑŒ±"]
    ],
    family: [
      ["mother","ŒºŒ∑œÑŒ≠œÅŒ±"],["father","œÄŒ±œÑŒ≠œÅŒ±œÇ"],["brother","Œ±Œ¥ŒµœÅœÜœåœÇ"],["sister","Œ±Œ¥ŒµœÅœÜŒÆ"],["son","Œ≥ŒπŒøœÇ"],
      ["daughter","Œ∫œåœÅŒ∑"],["grandmother","Œ≥ŒπŒ±Œ≥ŒπŒ¨"],["grandfather","œÄŒ±œÄœÄŒøœçœÇ"],["uncle","Œ∏ŒµŒØŒøœÇ"],["aunt","Œ∏ŒµŒØŒ±"],
      ["cousin","ŒæŒ¨Œ¥ŒµœÅœÜŒøœÇ"],["family","ŒøŒπŒ∫ŒøŒ≥Œ≠ŒΩŒµŒπŒ±"],["parents","Œ≥ŒøŒΩŒµŒØœÇ"],["child","œÄŒ±ŒπŒ¥ŒØ"],["baby","ŒºœâœÅœå"]
    ],
    body: [
      ["head","Œ∫ŒµœÜŒ¨ŒªŒπ"],["hand","œáŒ≠œÅŒπ"],["foot","œÄœåŒ¥Œπ"],["arm","ŒºœÄœÅŒ¨œÑœÉŒø"],["leg","œÄœåŒ¥Œπ"],
      ["eye","ŒºŒ¨œÑŒπ"],["ear","Œ±œÖœÑŒØ"],["nose","ŒºœçœÑŒ∑"],["mouth","œÉœÑœåŒºŒ±"],["hair","ŒºŒ±ŒªŒªŒπŒ¨"],
      ["finger","Œ¥Œ¨œáœÑœÖŒªŒø"],["shoulder","œéŒºŒøœÇ"],["knee","Œ≥œåŒΩŒ±œÑŒø"],["heart","Œ∫Œ±œÅŒ¥ŒπŒ¨"],["back","œÄŒªŒ¨œÑŒ∑"]
    ],
    days: [
      ["Monday","ŒîŒµœÖœÑŒ≠œÅŒ±"],["Tuesday","Œ§œÅŒØœÑŒ∑"],["Wednesday","Œ§ŒµœÑŒ¨œÅœÑŒ∑"],["Thursday","Œ†Œ≠ŒºœÄœÑŒ∑"],["Friday","Œ†Œ±œÅŒ±œÉŒ∫ŒµœÖŒÆ"],
      ["Saturday","Œ£Œ¨Œ≤Œ≤Œ±œÑŒø"],["Sunday","ŒöœÖœÅŒπŒ±Œ∫ŒÆ"],["January","ŒôŒ±ŒΩŒøœÖŒ¨œÅŒπŒøœÇ"],["February","Œ¶ŒµŒ≤œÅŒøœÖŒ¨œÅŒπŒøœÇ"],["March","ŒúŒ¨œÅœÑŒπŒøœÇ"],
      ["April","ŒëœÄœÅŒØŒªŒπŒøœÇ"],["May","ŒúŒ¨ŒπŒøœÇ"],["June","ŒôŒøœçŒΩŒπŒøœÇ"],["July","ŒôŒøœçŒªŒπŒøœÇ"],["August","ŒëœçŒ≥ŒøœÖœÉœÑŒøœÇ"],
      ["September","Œ£ŒµœÄœÑŒ≠ŒºŒ≤œÅŒπŒøœÇ"],["October","ŒüŒ∫œÑœéŒ≤œÅŒπŒøœÇ"],["November","ŒùŒøŒ≠ŒºŒ≤œÅŒπŒøœÇ"],["December","ŒîŒµŒ∫Œ≠ŒºŒ≤œÅŒπŒøœÇ"]
    ],
    school: [
      ["school","œÉœáŒøŒªŒµŒØŒø"],["teacher","Œ¥Œ¨œÉŒ∫Œ±ŒªŒøœÇ"],["student","ŒºŒ±Œ∏Œ∑œÑŒÆœÇ"],["book","Œ≤ŒπŒ≤ŒªŒØŒø"],["pen","œÉœÑœÖŒªœå"],
      ["pencil","ŒºŒøŒªœçŒ≤Œπ"],["table","œÑœÅŒ±œÄŒ≠Œ∂Œπ"],["chair","Œ∫Œ±œÅŒ≠Œ∫ŒªŒ±"],["classroom","œÑŒ¨ŒæŒ∑"],["homework","ŒµœÅŒ≥Œ±œÉŒØŒ±"],
      ["exam","ŒµŒæŒ≠œÑŒ±œÉŒ∑"],["lesson","ŒºŒ¨Œ∏Œ∑ŒºŒ±"],["maths","ŒºŒ±Œ∏Œ∑ŒºŒ±œÑŒπŒ∫Œ¨"],["science","ŒµœÄŒπœÉœÑŒÆŒºŒ∑"],["history","ŒπœÉœÑŒøœÅŒØŒ±"]
    ],
    phrases: [
      ["hello","Œ≥ŒµŒπŒ± œÉŒøœÖ"],["goodbye","Œ±ŒΩœÑŒØŒø"],["please","œÄŒ±œÅŒ±Œ∫Œ±Œªœé"],["thank you","ŒµœÖœáŒ±œÅŒπœÉœÑœé"],["yes","ŒΩŒ±Œπ"],
      ["no","œåœáŒπ"],["how are you","œÄœéœÇ ŒµŒØœÉŒ±Œπ"],["my name is","ŒºŒµ ŒªŒ≠ŒΩŒµ"],["excuse me","œÉœÖŒ≥Œ≥ŒΩœéŒºŒ∑"],["sorry","ŒªœÖœÄŒ¨ŒºŒ±Œπ"],
      ["good morning","Œ∫Œ±ŒªŒ∑ŒºŒ≠œÅŒ±"],["good evening","Œ∫Œ±ŒªŒ∑œÉœÄŒ≠œÅŒ±"],["good night","Œ∫Œ±ŒªŒ∑ŒΩœçœáœÑŒ±"],["see you later","œÑŒ± ŒªŒ≠ŒºŒµ"],["well done","ŒºœÄœÅŒ¨Œ≤Œø"]
    ],
    nature: [
      ["tree","Œ¥Œ≠ŒΩœÑœÅŒø"],["flower","ŒªŒøœÖŒªŒøœçŒ¥Œπ"],["sun","ŒÆŒªŒπŒøœÇ"],["moon","œÜŒµŒ≥Œ≥Œ¨œÅŒπ"],["star","Œ±œÉœÑŒ≠œÅŒπ"],
      ["sea","Œ∏Œ¨ŒªŒ±œÉœÉŒ±"],["mountain","Œ≤ŒøœÖŒΩœå"],["river","œÄŒøœÑŒ¨ŒºŒπ"],["sky","ŒøœÖœÅŒ±ŒΩœåœÇ"],["rain","Œ≤œÅŒøœáŒÆ"],
      ["snow","œáŒπœåŒΩŒπ"],["wind","Œ¨ŒΩŒµŒºŒøœÇ"],["forest","Œ¥Œ¨œÉŒøœÇ"],["garden","Œ∫ŒÆœÄŒøœÇ"],["beach","œÄŒ±œÅŒ±ŒªŒØŒ±"]
    ]
  }
};

// Flat lookup dictionary for auto-translate in custom lists
const lookupDict = {};
for (const lang of Object.keys(vocab)) {
  lookupDict[lang] = {};
  for (const cat of Object.keys(vocab[lang])) {
    for (const [en, foreign] of vocab[lang][cat]) {
      lookupDict[lang][en.toLowerCase()] = foreign;
    }
  }
}

const langNames = { french: "French", russian: "Russian", latin: "Latin", greek: "Greek" };

// ==========================================
// TAB SWITCHING
// ==========================================
document.querySelectorAll('.tab-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('tab-' + btn.dataset.tab).classList.add('active');
    if (btn.dataset.tab === 'saved') loadSavedLists();
  });
});

// ==========================================
// WORD COUNT UPDATE
// ==========================================
function updateWordCount() {
  const lang = document.getElementById('langSelect').value;
  const cat = document.getElementById('catSelect').value;
  const words = vocab[lang]?.[cat] || [];
  document.getElementById('wordCount').textContent = words.length + ' words available';
}

document.getElementById('langSelect').addEventListener('change', updateWordCount);
document.getElementById('catSelect').addEventListener('change', updateWordCount);
updateWordCount();

// ==========================================
// QUIZ ENGINE
// ==========================================
let quizWords = [];
let quizIndex = 0;
let quizCorrect = 0;
let quizWrong = 0;
let quizStreak = 0;
let quizBestStreak = 0;
let missedWords = [];
let currentDirection = '';
let currentLang = '';
let quizTotal = 0;
let lastQuizConfig = null;

function shuffle(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function startQuiz(customWords) {
  const lang = document.getElementById('langSelect').value;
  const cat = document.getElementById('catSelect').value;
  const dir = document.getElementById('dirSelect').value;
  const num = document.getElementById('numSelect').value;
  currentLang = lang;

  let words = customWords || vocab[lang]?.[cat] || [];
  if (words.length === 0) return alert('No words in this category!');

  words = shuffle(words);
  const count = num === 'all' ? words.length : Math.min(parseInt(num), words.length);
  quizWords = words.slice(0, count);
  quizTotal = quizWords.length;
  quizIndex = 0;
  quizCorrect = 0;
  quizWrong = 0;
  quizStreak = 0;
  quizBestStreak = 0;
  missedWords = [];
  currentDirection = dir;

  lastQuizConfig = { lang, cat, dir, num, customWords };

  document.getElementById('setupArea').classList.add('hidden');
  document.getElementById('quizArea').classList.add('active');
  document.getElementById('resultsScreen').classList.remove('active');

  showQuestion();
}

function showQuestion() {
  const [en, foreign] = quizWords[quizIndex];
  let showForeignPrompt = currentDirection === 'foreign-to-en';
  if (currentDirection === 'mixed') showForeignPrompt = Math.random() > 0.5;

  const langLabel = langNames[currentLang] || currentLang;

  if (showForeignPrompt) {
    document.getElementById('quizDirection').textContent = `Translate to English`;
    document.getElementById('quizWord').textContent = foreign;
    document.getElementById('quizLang').textContent = langLabel;
    document.getElementById('answerInput').dataset.expected = en.toLowerCase();
    document.getElementById('answerInput').dataset.showAnswer = en;
  } else {
    document.getElementById('quizDirection').textContent = `Translate to ${langLabel}`;
    document.getElementById('quizWord').textContent = en;
    document.getElementById('quizLang').textContent = 'English';
    document.getElementById('answerInput').dataset.expected = foreign.toLowerCase();
    document.getElementById('answerInput').dataset.showAnswer = foreign;
  }

  document.getElementById('answerInput').value = '';
  document.getElementById('answerInput').className = 'answer-input';
  document.getElementById('feedback').textContent = '';
  document.getElementById('feedback').className = 'feedback';
  document.getElementById('checkBtn').style.display = 'inline-block';
  document.getElementById('nextBtn').style.display = 'none';
  document.getElementById('answerInput').focus();

  updateScoreboard();
}

function checkAnswer() {
  const input = document.getElementById('answerInput');
  const expected = input.dataset.expected;
  const showAnswer = input.dataset.showAnswer;
  const userAnswer = input.value.trim().toLowerCase();

  if (!userAnswer) return;

  const fb = document.getElementById('feedback');

  if (userAnswer === expected) {
    quizCorrect++;
    quizStreak++;
    if (quizStreak > quizBestStreak) quizBestStreak = quizStreak;
    input.className = 'answer-input correct';
    fb.className = 'feedback correct-fb';
    fb.innerHTML = quizStreak > 2 ? `‚úÖ Correct! üî• ${quizStreak} streak!` : '‚úÖ Correct!';
  } else {
    quizWrong++;
    quizStreak = 0;
    input.className = 'answer-input wrong';
    fb.className = 'feedback wrong-fb';
    fb.innerHTML = `‚ùå Not quite.<div class="correct-answer">The answer was: <strong>${showAnswer}</strong></div>`;
    missedWords.push(quizWords[quizIndex]);
  }

  document.getElementById('checkBtn').style.display = 'none';
  document.getElementById('nextBtn').style.display = 'inline-block';
  updateScoreboard();
}

function nextQuestion() {
  quizIndex++;
  if (quizIndex >= quizTotal) {
    showResults();
  } else {
    showQuestion();
  }
}

function updateScoreboard() {
  document.getElementById('scoreCorrect').textContent = quizCorrect;
  document.getElementById('scoreWrong').textContent = quizWrong;
  document.getElementById('scoreProgress').textContent = `${quizIndex + 1}/${quizTotal}`;
  document.getElementById('scoreStreak').textContent = quizStreak;
  document.getElementById('quizProgress').style.width = `${((quizIndex) / quizTotal) * 100}%`;
}

function showResults() {
  document.getElementById('quizArea').classList.remove('active');
  document.getElementById('resultsScreen').classList.add('active');

  const pct = Math.round((quizCorrect / quizTotal) * 100);
  document.getElementById('resultsScore').textContent = `${quizCorrect}/${quizTotal}`;

  let emoji, grade, color;
  if (pct === 100) { emoji = 'üèÜ'; grade = 'Perfect score! Incredible!'; color = '#ffd23f'; }
  else if (pct >= 80) { emoji = 'üéâ'; grade = 'Great job! Nearly perfect!'; color = 'var(--correct)'; }
  else if (pct >= 60) { emoji = 'üëç'; grade = 'Good effort! Keep practising!'; color = 'var(--accent)'; }
  else if (pct >= 40) { emoji = 'üí™'; grade = 'Getting there ‚Äî try again!'; color = '#ff9f1c'; }
  else { emoji = 'üìö'; grade = 'Keep going ‚Äî practice makes perfect!'; color = 'var(--wrong)'; }

  document.getElementById('resultsEmoji').textContent = emoji;
  document.getElementById('resultsGrade').textContent = grade;
  document.getElementById('resultsScore').style.color = color;

  const missedDiv = document.getElementById('missedWords');
  const missedList = document.getElementById('missedList');
  if (missedWords.length > 0) {
    missedDiv.style.display = 'block';
    missedList.innerHTML = missedWords.map(([en, foreign]) =>
      `<div class="missed-word-item"><span class="eng">${en}</span><span class="foreign">${foreign}</span></div>`
    ).join('');
  } else {
    missedDiv.style.display = 'none';
  }
}

function retryQuiz() {
  if (lastQuizConfig) {
    document.getElementById('resultsScreen').classList.remove('active');
    startQuiz(lastQuizConfig.customWords);
  }
}

function backToSetup() {
  document.getElementById('quizArea').classList.remove('active');
  document.getElementById('resultsScreen').classList.remove('active');
  document.getElementById('setupArea').classList.remove('hidden');
}

function endQuiz() {
  showResults();
}

// Enter key to check/next
document.getElementById('answerInput').addEventListener('keydown', (e) => {
  if (e.key === 'Enter') {
    if (document.getElementById('checkBtn').style.display !== 'none') {
      checkAnswer();
    } else {
      nextQuestion();
    }
  }
});

// ==========================================
// CUSTOM LIST BUILDER
// ==========================================
let customWords = [];

document.getElementById('newEnglish').addEventListener('input', function() {
  const lang = document.getElementById('customLang').value;
  const word = this.value.trim().toLowerCase();
  const foreignInput = document.getElementById('newForeign');
  const status = document.getElementById('lookupStatus');

  if (word && lookupDict[lang]?.[word]) {
    foreignInput.value = lookupDict[lang][word];
    status.textContent = '‚úì Found in dictionary!';
    status.className = 'lookup-status lookup-found';
  } else if (word) {
    foreignInput.value = '';
    status.textContent = 'Not in dictionary ‚Äî type the translation manually';
    status.className = 'lookup-status lookup-manual';
  } else {
    status.textContent = '';
  }
});

function addWordPair() {
  const en = document.getElementById('newEnglish').value.trim();
  const foreign = document.getElementById('newForeign').value.trim();

  if (!en || !foreign) return alert('Please enter both the English word and its translation.');

  customWords.push([en, foreign]);
  document.getElementById('newEnglish').value = '';
  document.getElementById('newForeign').value = '';
  document.getElementById('lookupStatus').textContent = '';
  renderCustomWords();
  document.getElementById('newEnglish').focus();
}

document.getElementById('newEnglish').addEventListener('keydown', (e) => {
  if (e.key === 'Enter') {
    const foreignInput = document.getElementById('newForeign');
    if (foreignInput.value) {
      addWordPair();
    } else {
      foreignInput.focus();
    }
  }
});

document.getElementById('newForeign').addEventListener('keydown', (e) => {
  if (e.key === 'Enter') addWordPair();
});

function renderCustomWords() {
  const list = document.getElementById('customWordsList');
  if (customWords.length === 0) {
    list.innerHTML = '<div class="empty-state">No words added yet</div>';
    return;
  }
  list.innerHTML = customWords.map((pair, i) =>
    `<div class="word-pair-row">
      <input type="text" value="${pair[0]}" readonly style="background:transparent; border-color: rgba(255,255,255,0.05);">
      <input type="text" value="${pair[1]}" readonly style="background:transparent; border-color: rgba(255,255,255,0.05);">
      <button class="remove-word" onclick="removeWord(${i})">√ó</button>
    </div>`
  ).join('');
}

function removeWord(i) {
  customWords.splice(i, 1);
  renderCustomWords();
}

function clearCustomWords() {
  customWords = [];
  renderCustomWords();
}

function saveCustomList() {
  const name = document.getElementById('customListName').value.trim();
  const lang = document.getElementById('customLang').value;

  if (!name) return alert('Please give your list a name.');
  if (customWords.length < 2) return alert('Add at least 2 words to save a list.');

  const lists = JSON.parse(localStorage.getItem('vocabLists') || '[]');
  lists.push({ name, lang, words: [...customWords], created: Date.now() });
  localStorage.setItem('vocabLists', JSON.stringify(lists));

  alert(`Saved "${name}" with ${customWords.length} words!`);
  customWords = [];
  document.getElementById('customListName').value = '';
  renderCustomWords();
}

// ==========================================
// SAVED LISTS
// ==========================================
function loadSavedLists() {
  const container = document.getElementById('savedListsContainer');
  let lists = [];
  try { lists = JSON.parse(localStorage.getItem('vocabLists') || '[]'); } catch(e) {}

  if (lists.length === 0) {
    container.innerHTML = '<div class="empty-state">No saved lists yet. Create one in the Custom Lists tab!</div>';
    return;
  }

  container.innerHTML = lists.map((list, i) =>
    `<div class="saved-list-item" onclick="practiceList(${i})">
      <div class="saved-list-info">
        <div class="name">${list.name}</div>
        <div class="meta">${langNames[list.lang] || list.lang} ¬∑ ${list.words.length} words</div>
      </div>
      <button class="delete-list" onclick="event.stopPropagation(); deleteList(${i})">üóë</button>
    </div>`
  ).join('');
}

function practiceList(i) {
  const lists = JSON.parse(localStorage.getItem('vocabLists') || '[]');
  const list = lists[i];
  if (!list) return;

  currentLang = list.lang;
  document.getElementById('langSelect').value = list.lang;

  // Switch to practice tab
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
  document.querySelector('[data-tab="practice"]').classList.add('active');
  document.getElementById('tab-practice').classList.add('active');

  startQuiz(list.words);
}

function deleteList(i) {
  if (!confirm('Delete this list?')) return;
  const lists = JSON.parse(localStorage.getItem('vocabLists') || '[]');
  lists.splice(i, 1);
  localStorage.setItem('vocabLists', JSON.stringify(lists));
  loadSavedLists();
}

renderCustomWords();
</script>

</body>
</html>